!function(e,t,n,a){function o(){l.debug}var r=null,i="",s=0,u={},c={content:"#content",cacheRequests:!0,cacheExpiry:1,waitForImages:!0,debug:!1,testMode:!1},l=c,d=e("body"),g=e("wpvars"),f=e(l.content);e(t).off("statechange").on("statechange",function(){var e=a.getState();o("Event.statechange: HTML5 History statechange event trigger with URL: "+e.url),i!==e.url?(o("Event.statechange: Calling the wpAjax.loadPage function with State.url as its parameter"),u.loadPage(e.url)):o("Event.statechange: User is already on the requested page to load. No request will be made.")}),u.configure=function(t){return o("configure: Setting options for Wpajax"),e.extend(c,t),this},u.getConfiguration=function(){return c},u.getCurrentUrl=function(){return o("getCurrentUrl: Getting the current browser address URL"),t.location.href},u.trigger=function(e){o("trigger: Calling History.pushState which will trigger a statechange"),i=u.getCurrentUrl(),u.getTitle(e,function(t){a.pushState({},t,e)})},u.pageLimitReached=function(){return wpvars.max==wpvars.paged},u.getCurrentPageNumber=function(){return wpvars.paged},u.getMaxPages=function(){return wpvars.max},u.loadPage=function(t){if(o("loadPage: No other request is taking place, we are good to go"),!l.testMode){d.addClass("loading-page");var a=jQuery.Event("wpAjax.loading",{previousUrl:i,url:t});e(n).trigger(a),u.fadeOutContent(),o("loadPage: Loading class applied to body, loading event fired and content element faded out")}u.doRequest(t,function(e){u.processRequest(e,t)},function(){if(!l.testMode){u.fadeInContent(),o("loadPage: Called doRequest and the request failed. Throwing a failed event on document");var a=jQuery.Event("wpAjax.failed",{url:t});e(n).trigger(a)}})},u.fadeOutContent=function(){o("fadeOutContent: Animating content element out"),f.animate({opacity:0},800)},u.fadeInContent=function(){o("fadeInContent: Animating content element in"),f.animate({opacity:1},800)},u.getTitle=function(t,n){var a="";o("getTitle: Calling wpAjax.doRequest now to get the title"),u.doRequest(t,function(t){a=e(t).filter("title").text(),o("getTitle: doRequest AJAX call successful. Title returned: "+a+" "),e.isFunction(n)&&n(a)},function(){e.isFunction(n)&&n(a)})},u.doRequest=function(t,n,a){o("doRequest: About to perform an AJAX call"),r=e.ajax({url:t,localCache:l.cacheRequests,cacheTTL:l.cacheExpiry,type:"GET",dataType:"html",requestCount:++s,beforeSend:function(){null!==r&&r.abort()},success:function(e,t,a){o("doRequest: AJAX success callback"),s===this.requestCount&&n(e,t,a)},error:function(t,n,r){o("doRequest: AJAX error callback"),e.isFunction(a)&&a(t,n,r)}})},u.processRequest=function(t,a){var r=e(t);if(l.testMode)var i=r.find("body").html();else var i=r.find(l.content).html(),s=r.find("#wpvars").html();if(o("processRequest: Processing the data returned by a successful AJAX call"),i&&i.length){l.testMode||g.html(s);var c=jQuery.Event("wpAjax.loaded",{data:t,url:a});e(n).trigger(c),o("processRequest: Content found from the AJAX request, determining what to do with it"),l.waitForImages?(o("processRequest Wait for images option is enabled, finding images"),e(i).find("img").length?(o("processRequest: We found images. Waiting for all images in the returned data to preload"),u.populateContent(i,function(t){o("processRequest: Populated the content element with content, about to preload iamges"),t.waitForImages(function(){o("processRequest: All images in AJAX loaded content have preloaded"),d.attr("class",r.filter("body").attr("class"));var a=jQuery.Event("wpAjax.complete",{contentEl:t});e(n).trigger(a)})})):u.populateContent(i,function(t){o("processRequest: Requested AJAX content has been added to the content element and classes changed"),d.attr("class",r.filter("body").attr("class"));var a=jQuery.Event("wpAjax.complete",{contentEl:t});e(n).trigger(a)})):u.populateContent(i,function(a){o("processRequest: Requested AJAX content has been added to the content element and classes changed"),d.attr("class",t.filter("body").attr("class"));var r=jQuery.Event("wpAjax.complete",{contentEl:a});e(n).trigger(r)}),u.fadeInContent()}else o("processRequest: Returned AJAX content is empty. Could be a problem server-side.")},u.populateContent=function(t,n){o("populateContent: About to populate the content element with returned HTML"),l.testMode||f.html(t),e.isFunction(n)&&(o("populateContent: We've added in the content, calling the callback function with the element as an argument"),n(f))},t.wpAjax=u}(jQuery,window,window.document,window.History);